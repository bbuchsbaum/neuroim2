% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/affine_utils.R
\name{affine_utils}
\alias{affine_utils}
\alias{apply_affine}
\alias{to_matvec}
\alias{from_matvec}
\alias{append_diag}
\alias{dot_reduce}
\alias{voxel_sizes}
\alias{obliquity}
\alias{rescale_affine}
\title{Affine utility functions}
\usage{
apply_affine(aff, pts, inplace = FALSE)

to_matvec(transform)

from_matvec(matrix, vector = NULL)

append_diag(aff, steps, starts = numeric(0))

dot_reduce(...)

voxel_sizes(affine)

obliquity(affine)

rescale_affine(affine, shape, zooms, new_shape = NULL)
}
\arguments{
\item{aff}{Base affine matrix.}

\item{pts}{Points with last dimension `N - 1`; shape may be vector, matrix,
or higher-dimensional array.}

\item{inplace}{Included for API compatibility; ignored in R.}

\item{transform}{Homogeneous transform matrix.}

\item{matrix}{Linear part of transform (`N x M`).}

\item{vector}{Optional translation vector of length `N`.}

\item{steps}{Diagonal values for appended dimensions.}

\item{starts}{Optional translations for appended dimensions.}

\item{...}{Matrices/vectors compatible with \code{\%*\%}.}

\item{affine}{Square homogeneous affine matrix.}

\item{shape}{Original grid shape (spatial axes).}

\item{zooms}{New voxel sizes for spatial axes.}

\item{new_shape}{Optional new grid shape; defaults to `shape`.}
}
\value{
Points transformed by `aff`, with same leading shape as `pts`.

A list with `matrix` and `vector`.

Homogeneous affine matrix of shape `(N+1) x (M+1)`.

Expanded affine matrix.

Matrix product.

Numeric vector of voxel sizes (column norms of linear block).

Numeric vector of obliquity angles.

Rescaled affine matrix.
}
\description{
Utilities for point transforms and affine decomposition/composition.

Applies a homogeneous affine transform to points where the coordinate axis is
the last dimension.

Useful when expanding an affine to include additional dimensions.

For arrays `A, B, C, ...`, returns `A %*% (B %*% (C %*% ...))`.

Returns per-output-axis obliquity relative to cardinal axes, in radians.

Preserves rotations/shears and world location of the center voxel.
}
\details{
These functions mirror core NiBabel affine helpers while using R-first
conventions and stronger argument checks.
}
\examples{
aff <- diag(c(2, 3, 4, 1))
aff[1:3, 4] <- c(10, 20, 30)

pts <- rbind(c(1, 2, 3), c(4, 5, 6))
apply_affine(aff, pts)

mv <- to_matvec(aff)
from_matvec(mv$matrix, mv$vector)
}
