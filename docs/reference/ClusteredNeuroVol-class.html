<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>ClusteredNeuroVol Class — ClusteredNeuroVol-class • neuroim2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><script src="../extra.js"></script><meta property="og:title" content="ClusteredNeuroVol Class — ClusteredNeuroVol-class"><meta name="description" content="This class represents a three-dimensional brain image divided into N disjoint
partitions or clusters. It extends the SparseNeuroVol class
to provide efficient storage and manipulation of clustered neuroimaging data.
Construct a ClusteredNeuroVol instance"><meta property="og:description" content="This class represents a three-dimensional brain image divided into N disjoint
partitions or clusters. It extends the SparseNeuroVol class
to provide efficient storage and manipulation of clustered neuroimaging data.
Construct a ClusteredNeuroVol instance"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">neuroim2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bbuchsbaum/neuroim2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>ClusteredNeuroVol Class</h1>
      <small class="dont-index">Source: <a href="https://github.com/bbuchsbaum/neuroim2/blob/HEAD/R/all_class.R" class="external-link"><code>R/all_class.R</code></a>, <a href="https://github.com/bbuchsbaum/neuroim2/blob/HEAD/R/clustervol.R" class="external-link"><code>R/clustervol.R</code></a></small>
      <div class="d-none name"><code>ClusteredNeuroVol-class.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This class represents a three-dimensional brain image divided into N disjoint
partitions or clusters. It extends the <code><a href="SparseNeuroVol-class.html">SparseNeuroVol</a></code> class
to provide efficient storage and manipulation of clustered neuroimaging data.</p>
<p>Construct a <code>ClusteredNeuroVol</code> instance</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ClusteredNeuroVol</span><span class="op">(</span><span class="va">mask</span>, <span class="va">clusters</span>, label_map <span class="op">=</span> <span class="cn">NULL</span>, label <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mask">mask<a class="anchor" aria-label="anchor" href="#arg-mask"></a></dt>
<dd><p>an instance of class <code><a href="LogicalNeuroVol-class.html">LogicalNeuroVol</a></code></p></dd>


<dt id="arg-clusters">clusters<a class="anchor" aria-label="anchor" href="#arg-clusters"></a></dt>
<dd><p>a vector of clusters ids with length equal to number of nonzero
voxels in mask <code>mask</code></p></dd>


<dt id="arg-label-map">label_map<a class="anchor" aria-label="anchor" href="#arg-label-map"></a></dt>
<dd><p>an optional <code>list</code> that maps from cluster id to a cluster
label, e.g. (1 -&gt; "FFA", 2 -&gt; "PPA")</p></dd>


<dt id="arg-label">label<a class="anchor" aria-label="anchor" href="#arg-label"></a></dt>
<dd><p>an optional <code>character</code> string used to label of the volume</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>ClusteredNeuroVol</code> instance</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The ClusteredNeuroVol class is designed for efficient representation and
manipulation of brain images with distinct, non-overlapping regions or clusters.
It combines the memory efficiency of sparse representations with additional
structures for managing cluster information.</p>
<p>The use case of <code>ClusteredNeuroVol</code> is to store volumetric data that has been clustered into discrete sets of voxels,
each of which has an associated id. For example, this class can be used to represent parcellated neuroimaging volumes.</p>
    </div>
    <div class="section level2">
    <h2 id="slots">Slots<a class="anchor" aria-label="anchor" href="#slots"></a></h2>


<dl><dt><code>mask</code></dt>
<dd><p>A <code><a href="LogicalNeuroVol-class.html">LogicalNeuroVol</a></code> object representing the logical
mask indicating the spatial domain of the set of clusters.</p></dd>


<dt><code>clusters</code></dt>
<dd><p>An integer vector representing the cluster number for each voxel
in the mask.</p></dd>


<dt><code>label_map</code></dt>
<dd><p>A named list where each element represents a cluster and its name.</p></dd>


<dt><code>cluster_map</code></dt>
<dd><p>An <code>environment</code> object that maps from cluster id to the
set of 1D spatial indices belonging to that cluster.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>


<p>This class inherits methods from the <code><a href="SparseNeuroVol-class.html">SparseNeuroVol</a></code> class.
Additional methods specific to cluster operations may be available.</p>
    </div>
    <div class="section level2">
    <h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h2>


<p>ClusteredNeuroVol objects are particularly useful for:</p><ul><li><p>Representing parcellated brain images</p></li>
<li><p>Storing results of clustering algorithms applied to neuroimaging data</p></li>
<li><p>Efficient manipulation and analysis of region-based neuroimaging data</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="SparseNeuroVol-class.html">SparseNeuroVol-class</a></code> for the parent sparse volume class.
<code><a href="LogicalNeuroVol-class.html">LogicalNeuroVol-class</a></code> for the mask representation.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a simple clustered brain volume</span></span></span>
<span class="r-in"><span><span class="va">dim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10L</span>, <span class="fl">10L</span>, <span class="fl">10L</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mask_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>, <span class="fl">500</span><span class="op">)</span>, <span class="va">dim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mask</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"LogicalNeuroVol"</span>, .Data <span class="op">=</span> <span class="va">mask_data</span>,</span></span>
<span class="r-in"><span>            space <span class="op">=</span> <span class="fu"><a href="NeuroSpace.html">NeuroSpace</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="va">dim</span>, origin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mask_data</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">label_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Cluster1"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"Cluster2"</span> <span class="op">=</span> <span class="fl">2</span>, <span class="st">"Cluster3"</span> <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                  <span class="st">"Cluster4"</span> <span class="op">=</span> <span class="fl">4</span>, <span class="st">"Cluster5"</span> <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cluster_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">cluster_map</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">clusters</span> <span class="op">==</span> <span class="va">i</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">clustered_vol</span> <span class="op">&lt;-</span> <span class="fu">ClusteredNeuroVol</span><span class="op">(</span></span></span>
<span class="r-in"><span>                     mask <span class="op">=</span> <span class="va">mask</span>,</span></span>
<span class="r-in"><span>                     clusters <span class="op">=</span> <span class="va">clusters</span>,</span></span>
<span class="r-in"><span>                     label_map <span class="op">=</span> <span class="va">label_map</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a simple space and volume</span></span></span>
<span class="r-in"><span><span class="va">space</span> <span class="op">&lt;-</span> <span class="fu"><a href="NeuroSpace.html">NeuroSpace</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">16</span>, <span class="fl">16</span><span class="op">)</span>, spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vol_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">16</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">16</span>, <span class="fl">16</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vol</span> <span class="op">&lt;-</span> <span class="fu"><a href="NeuroVol.html">NeuroVol</a></span><span class="op">(</span><span class="va">vol_data</span>, <span class="va">space</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a binary mask (e.g., values &gt; 0)</span></span></span>
<span class="r-in"><span><span class="va">mask_data</span> <span class="op">&lt;-</span> <span class="va">vol_data</span> <span class="op">&gt;</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">mask_vol</span> <span class="op">&lt;-</span> <span class="fu"><a href="LogicalNeuroVol-class.html">LogicalNeuroVol</a></span><span class="op">(</span><span class="va">mask_data</span>, <span class="va">space</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get coordinates of masked voxels</span></span></span>
<span class="r-in"><span><span class="va">mask_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">mask_data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="index_to_coord-methods.html">index_to_coord</a></span><span class="op">(</span><span class="va">mask_vol</span>, <span class="va">mask_idx</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Cluster the coordinates into 10 groups</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>  <span class="co"># for reproducibility</span></span></span>
<span class="r-in"><span><span class="va">kmeans_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></span><span class="op">(</span><span class="va">coords</span>, centers <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create the clustered volume</span></span></span>
<span class="r-in"><span><span class="va">clustered_vol</span> <span class="op">&lt;-</span> <span class="fu">ClusteredNeuroVol</span><span class="op">(</span><span class="va">mask_vol</span>, <span class="va">kmeans_result</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Print information about the clusters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">clustered_vol</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB; font-weight: bold;">ClusteredNeuroVol</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #555555;">============================================================</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;"> &gt; Type:          </span> <span style="color: #BBBBBB;">Clustered Volume</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;"> &gt; Dimensions:    </span> <span style="color: #BBBBBB;">16 x 16 x 16</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;"> &gt; Spacing:       </span> <span style="color: #BBBBBB;">1 x 1 x 1</span>   <span style="color: #555555;">mm</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;"> &gt; Origin:        </span> <span style="color: #BBBBBB;">0 x 0 x 0</span>   <span style="color: #555555;">mm</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;"> &gt; Orientation:   </span> <span style="color: #BBBBBB;">Left-to-Right Posterior-to-Anterior Inferior-to-Superior</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #00BBBB; font-weight: bold;">Cluster Information</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #555555;">----------------------------------------</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;"> &gt; Total Clusters:</span> <span style="color: #BBBBBB;">10</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;"> &gt; Active Voxels: </span> <span style="color: #BBBBBB;">1994</span>   <span style="color: #555555;">(48.7% of volume)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #BB00BB; font-weight: bold;">Region Labels</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #555555;">----------------------------------------</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;"> &gt; </span> <span style="color: #BBBBBB;">Clus_1              </span> <span style="color: #555555;">[1]</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;"> &gt; </span> <span style="color: #BBBBBB;">Clus_2              </span> <span style="color: #555555;">[2]</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;"> &gt; </span> <span style="color: #BBBBBB;">Clus_3              </span> <span style="color: #555555;">[3]</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;"> &gt; </span> <span style="color: #BBBBBB;">Clus_4              </span> <span style="color: #555555;">[4]</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;"> &gt; </span> <span style="color: #BBBBBB;">Clus_5              </span> <span style="color: #555555;">[5]</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #555555;">   ... and 5 more regions</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bradley R Buchsbaum.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

